# Meta AI Demos 「Create 3D models」UI 詳細仕様

## 0. 画面・座標系の前提

- ビューポート全体を 1×1 の正規化座標で扱う。
  - 原点: 左上 `(0, 0)`
  - 右下: `(1, 1)`
- 横幅方向: `x`、縦方向: `y`
- レイアウトはおおよそ以下の3分割：
  - 左サイドバー: `x ∈ [0.00, 0.20]`
  - メインワークスペース: `x ∈ [0.20, 1.00]`
  - メイン内でさらに上下・左右に分割

以降、`region: x=[a,b], y=[c,d]` という形で領域を示す。

---

## 1. 画面A：初期状態（画像未選択時）

### 1.1 レイアウト概要

- 左サイドバー（How it works + モデル選択）
  - `region: x=[0.00, 0.20], y=[0.00, 1.00]`
- 右側メイン領域（中央のアップロードエリア＋サンプル画像行）
  - `region: x=[0.20, 1.00], y=[0.00, 1.00]`
  - 上部 3Dモデル作成エリア: `y=[0.00, 0.70]`
  - 下部 サンプル画像エリア: `y=[0.70, 0.95]`

---

### 1.2 左サイドバー

#### (A-L1) 画面タイトル

- 文言: `Create 3D models`
- 説明文: `Create 3D models of objects from images`
- 位置:
  - `region: x=[0.03, 0.18], y=[0.03, 0.13]`
- 特徴:
  - タイトルは太字・大フォント
  - 説明文はやや小さめのグレー文字

#### (A-L2) How it works セクション

- 見出し: `How it works`
- 3ステップの説明カード（縦並び）
  - `region: x=[0.03, 0.18], y=[0.15, 0.45]`
- 各行：
  1. `1. Choose an image`
  2. `2. Select objects`
  3. `3. Create 3D models`
- UI仕様:
  - 左側に番号バッジ、右にテキスト
  - 現在のステップは強調表示（初期状態はステップ1が強調）

#### (A-L3) モデル選択

- ラベル: `Model`
- セレクタ: ピル型のボタン
  - デフォルト表示: `SAM 3D Objects`
- 位置:
  - `region: x=[0.03, 0.18], y=[0.50, 0.56]`
- 挙動:
  - クリックするとモーダルかドロップダウンで他モデルに切替（現状は `SAM 3D Objects` 固定想定）

---

### 1.3 右側メイン：画像アップロード

#### (A-M1) 画像アップロードエリア（ドロップゾーン）

- 大きな破線枠の矩形領域。
- 文言: `Start with your own image`
- アイコン: 画像スタック風の白いアイコン
- 中央に `Upload` ボタン。
- 位置:
  - 枠全体: `x=[0.24, 0.96], y=[0.06, 0.72]`
  - アイコン＆文言のセンター:
    - おおよそ `x≈0.60, y≈0.35`
  - `Upload` ボタン:
    - `region: x=[0.56, 0.64], y=[0.40, 0.45]`
- 挙動:
  - 枠内クリック or `Upload` ボタンクリックでファイル選択ダイアログ。
  - 画像ドロップにも対応する想定（ドラッグオーバー時に枠のハイライト）。

#### (A-M2) サンプル画像セクション

- セクションタイトル: `Or try a sample image`
- 位置:
  - タイトル: `x=[0.40, 0.70], y=[0.72, 0.78]`
- サンプル画像サムネイル列:
  - 3枚程度の横並びカード
  - `region: x=[0.33, 0.80], y=[0.78, 0.92]`
- `Browse images` ボタン:
  - サンプル画像列の下中央に丸角ボタン
  - `region: x=[0.52, 0.62], y=[0.90, 0.95]`
- 挙動:
  - サンプルサムネイルをクリックすると、その画像が選択されて「画面B」に遷移。

---

## 2. 画面B：画像読み込み後／3D生成前（マスク編集フェーズ）

この状態は2枚目のスクリーンショット。

### 2.1 全体レイアウト

- 左サイドバーは画面Aと同じ（How it works はステップ2が強調される想定）。
- メイン領域は **上下2分割ではなく左右2分割** になる：

  - 左: 2D画像＆マスク編集キャンバス
    - `region: x=[0.20, 0.60], y=[0.10, 0.90]`
  - 右: 3Dプレビューキャンバス（この段階では空）
    - `region: x=[0.60, 1.00], y=[0.10, 0.90]`
- 上部にオブジェクトタブバー
  - `region: x=[0.20, 0.60], y=[0.02, 0.10]`
- 下部にマスク編集ツールバー
  - `region: x=[0.20, 0.60], y=[0.90, 0.98]`
- 右下に3Dビュー操作ツールバー（この段階ではほぼ無効）
  - `region: x=[0.78, 0.98], y=[0.90, 0.98]`

---

### 2.2 上部：オブジェクトタブバー

#### (B-T1) オブジェクトスロット

- 一番左に小さな正方形のスロット（現在のオブジェクト）。
- 初期状態ではアイコンのみ・真っ黒背景＋小さなオレンジの線画（ソーセージのような）で「オブジェクト1」を表す。
- 位置:
  - `region: x=[0.22, 0.26], y=[0.03, 0.08]`

#### (B-T2) 「Add object +」ボタン

- ラベル: `Add object +`
- 位置:
  - ボタン全体: `region: x=[0.27, 0.38], y=[0.03, 0.08]`
- 挙動:
  - 現在のマスクを1つのオブジェクトとして確定し、
    新しいオブジェクトスロットを追加。
  - 画面Cでは、このスロットが2つ表示される。

---

### 2.3 左メインキャンバス：2D画像＆マスク編集

#### (B-L1) 画像キャンバス

- アップロード済み画像が表示される矩形。
- 描画領域:
  - `region: x=[0.20, 0.60], y=[0.20, 0.80]`
- 特徴:
  - 画像は中央揃え・アスペクト比維持でフィット。
  - 背景は真っ黒のキャンバス。

#### (B-L2) マスク表示

- このスクショでは最上段のいくつかの食材上部が、ピンクの楕円マスクで塗られている（Addモードでクリックした結果）。
- マスクは画像上に半透明色でオーバーレイ。
- クリック位置には中央に小さな水色のポイントマーカー。

#### (B-L3) クリックインタラクション

- クリック位置は正規化座標としてバックエンドに送信される想定。
  - 画像キャンバス内のローカル座標 `u,v ∈ [0,1]` に変換して利用。
- Addモード:
  - クリックした周囲のオブジェクトがマスクに追加される。
- Removeモード:
  - クリックした部分がマスクから除外される。

---

### 2.4 右メインキャンバス：3Dプレビュー（空状態）

- 位置:
  - `region: x=[0.60, 1.00], y=[0.10, 0.90]`
- この段階ではまだ 3D 未生成のため、完全に黒い背景のみ。
- 3Dビュー操作用アイコンは右下に待機。

---

### 2.5 下部：マスク編集ツールバー

位置：`x=[0.20, 0.60], y=[0.90, 0.98]`

構成要素：

#### (B-B1) 「Edit mask」ラベル

- 左側に小さなテキスト `Edit mask`
- `region: x=[0.21, 0.28], y=[0.91, 0.96]`

#### (B-B2) モードトグル：Add / Remove

- ピル型のボタン。
- 左: `Add`（選択状態・ハイライト）
  - `region: x=[0.30, 0.36], y=[0.91, 0.96]`
- 右: `Remove`
  - `region: x=[0.37, 0.45], y=[0.91, 0.96]`
- 挙動:
  - Add: クリックポイントを「正例」として SAM3 に渡す。
  - Remove: クリックポイントを「負例」として SAM3 に渡す。

#### (B-B3) 「Generate 3D」ボタン

- ツールバー右寄りに大きなボタン。
- 文言: `Generate 3D`
- アイコン: 小さなワイヤーフレームの立方体
- 位置:
  - `region: x=[0.48, 0.60], y=[0.90, 0.98]`
- 挙動:
  - 現在のマスクを SAM3D Objects に投入し、3D生成ジョブを開始する。
  - 押下後は、右メインキャンバスに生成結果が現れる（画面C）。

---

### 2.6 右下：3Dビュー操作ツールバー（待機状態）

位置：`x=[0.80, 0.98], y=[0.90, 0.98]`

この段階では3Dオブジェクトがまだ無いが、UIとしてはアイコン列が表示されている。

想定されるアイコン（左から右）：

1. カメラコントロール（オービット）
2. フォーカス／ターゲット
3. ズームフィット
4. リセットビュー
5. シーンクリア（ゴミ箱）
6. 拡大表示（フルスクリーン）

※ 正確な機能名は公開資料に依存するが、3Dビュー標準ツールバーとして再実装すればよい。

---

## 3. 画面C：3D生成後（オブジェクト複数）

3枚目のスクリーンショットに相当。

### 3.1 上部：オブジェクトタブバー（複数オブジェクト）

#### (C-T1) オブジェクトサムネイル群

- 左上に、2つのオブジェクトサムネイルが横並びに表示される。
- それぞれ小さな四角の中に、対応する3Dオブジェクトの簡易アイコン（ソーセージ型）が描画される。

- 1つ目:
  - `region: x=[0.22, 0.26], y=[0.03, 0.08]`
  - 選択状態（ボーダー or 明度で強調）
- 2つ目:
  - `region: x=[0.27, 0.31], y=[0.03, 0.08]`
  - 非選択状態（背景暗め）

#### (C-T2) 「Add object +」ボタン（同様）

- `region: x=[0.32, 0.43], y=[0.03, 0.08]`
- 新規オブジェクト追加用。

---

### 3.2 左メインキャンバス：2D画像 & マスク

- 画像キャンバス自体の位置は画面Bと同じ：
  - `region: x=[0.20, 0.60], y=[0.20, 0.80]`
- このスクショでは、画像上に水色の円形マーカーが2箇所（2つ目のオブジェクトの Add ポイント）表示されている。
- 現在選択中のオブジェクトに対応するマスクが強調表示される。

---

### 3.3 右メインキャンバス：3Dオブジェクト表示

- `region: x=[0.60, 1.00], y=[0.10, 0.90]`
- 2つの3Dオブジェクト（パンのようなソーセージ形状）が表示されている。

  - 左オブジェクト（例: 焦げ目付きパン）
    - 画面座標: おおよそ `x≈0.68, y≈0.55`
  - 右オブジェクト（例: ソーセージ）
    - 画面座標: おおよそ `x≈0.82, y≈0.55`

- オブジェクト間には若干の距離があり、
  シーン原点が画面中央やや左側に位置していると推測される。

---

### 3.4 3Dビュー操作ツールバー（有効状態）

位置：`x=[0.80, 0.98], y=[0.90, 0.98]`

- アイコン列がアクティブになり、以下のような挙動を持つ想定：

1. **Orbit / Move camera**
   - 3Dビュー全体のカメラ制御を有効にする（ドラッグで回転）。
2. **Focus on object**
   - 選択中オブジェクトにカメラを寄せる。
3. **Zoom to fit**
   - すべてのオブジェクトが画面に入るようにカメラ距離を調整。
4. **Reset view**
   - デフォルトのカメラ位置・向きに戻す。
5. **Delete selected object**
   - 右クリックや選択状態と組み合わせて、オブジェクトを削除。
6. **Toggle fullscreen / maximize 3D view**
   - 3Dビューを画面いっぱいに拡大。

---

### 3.5 下部：マスク編集ツールバー（再掲）

画面B同様だが、生成済みオブジェクトが存在する状態でも以下の要素は変わらない。

- `Edit mask` ラベル: `x=[0.21, 0.28], y=[0.91, 0.96]`
- `Add` / `Remove` トグル:
  - `Add` が選択状態（このスクショでは Add がハイライト）
- `Generate 3D` ボタン:
  - 再度押すことで、現在選択中オブジェクトの 3Dモデルを再生成（更新）する動作が自然。

---

## 4. このUIを再実装する際の最小要素

この3画面から、あなたの実装に絶対必要なのは以下：

1. **画像選択フェーズ（画面A）**
   - 左の How it works / Model セクション（ただの説明＋ラベル）
   - 中央のアップロードドロップゾーン
   - 下部のサンプル画像行

2. **マスク編集 & オブジェクト管理フェーズ（画面B/C）**
   - 上部オブジェクトタブバー（サムネイル + Add object）
   - 左メインキャンバス（画像 + マスク + クリック入力）
   - 下部ツールバー（Edit mask, Add/Remove, Generate 3D）
   - 右メインキャンバス（3Dビュー）
   - 右下 3Dビュー操作ツールバー

3. **状態遷移**
   - 画像未選択 → A
   - 画像選択後 → B
   - Generate 3D 完了 → C（3Dオブジェクト表示、オブジェクトタブ増加）

この仕様通りにレイアウトとコンポーネントを切っていけば、  
Meta の「Create 3D models」UIをほぼそのまま再現できます。
