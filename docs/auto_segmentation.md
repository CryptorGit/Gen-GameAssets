# クリック → 自動セグメンテーション機能 仕様メモ（SAM3 前提）

## 1. 概要

- 目的  
  - ユーザーが **画像上をクリックするだけ**で、その周囲のオブジェクトを **自動セグメンテーション（マスク生成）**する。
  - 生成したマスクは、その後の **3D生成（SAM3D Objects / Body）** の入力として利用する。

- 使用モデル  
  - **SAM 3 (Segment Anything Model 3)**  
    - 画像・動画に対して、ポイント／ボックス／テキストなどのプロンプトからマスクを生成するモデル。  

---

## 2. フロントエンド側の挙動

### 2.1 ユーザー操作フロー

1. 画像を表示する。
2. ユーザーが対象物の上をクリックする。
3. クリック位置が「正例ポイント（＋）」として記録される。
4. 必要に応じて、除外したい部分を「負例ポイント（−）」としてクリックする。
5. `マスク生成`（またはクリックごとに自動）でバックエンドへリクエスト送信。
6. バックエンドから返ってきたマスクを、画像上に半透明オーバーレイとして表示する。
7. マスクに満足したら `Add Object`（3D用オブジェクトとして確定）ボタンを押す。

### 2.2 送信データ（例）

```json
POST /api/segmentation/mask
Content-Type: application/json

{
  "scene_id": "scene_123",
  "image_id": "img_001",
  "points": {
    "positive": [[x1, y1], [x2, y2]],
    "negative": [[x3, y3]]
  },
  "prompt_type": "points",            // "points" | "box" | "text"
  "image_size": [width, height]       // フロント側座標系のサイズ
}
